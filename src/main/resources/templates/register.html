<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">

    <title>Register - E-commerce Shop</title>

    <style>
        body, html {
            height: 100%;
            margin: 0;
            background-color: #f8f9fa;
        }
		.navbar-blue {
		    background-color: #007bff; /* Blue background */
		}
		.navbar-blue .navbar-brand,
		.navbar-blue .nav-link {
		    color: #ffffff; /* White text */
		}
		.navbar-blue .nav-link.active {
		    color: #ffffff; /* White text for active link */
		}
		/* Custom CSS for positioning and sizing the dropdown menu */
		.navbar .dropdown-menu {
		    right: -10px; /* Adjust this value to add spacing from the right */
		    left: auto; /* Prevent auto left positioning */
		    max-width: 200px; /* Adjust this value to control the width */
		    width: auto; /* Ensure the width adjusts to max-width */
		}
		.card {
			border: 2px solid white; /* White border around the card */
			border-radius: 8px; /* Rounded corners for the border */
			padding: 15px; /* Adjusted padding inside the border */
			transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out; /* Smooth transition for scaling and shadow */
		}	
		.card:hover {
			transform: scale(1.05); /* Increase the size of the card */
			box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.3); /* Subtle shadow effect */
		}
				
		.fixed-width-container {
		    width: 1200px;
		    margin-top: 30px;
		}	
		/* Custom CSS for positioning and sizing the dropdown menu */
		.navbar .dropdown-menu {
			right: -10px; /* Adjust this value to add spacing from the right */
			left: auto; /* Prevent auto left positioning */
			max-width: 200px; /* Adjust this value to control the width */
			width: auto; /* Ensure the width adjusts to max-width */
		}

        /* Center the registration box using Flexbox */
        .container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        .register-box {
            width: 400px;
            padding: 30px;
            background-color: white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }

        .register-box h2 {
            margin-bottom: 20px;
        }

        .form-group {
            position: relative;
            margin-bottom: 1.5rem; /* Reduced margin */
        }

        .form-group input {
            width: 100%;
            padding: 10px;
            font-size: 1.2rem;
            background: none;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        .form-group label {
            position: absolute;
            top: 12px;
            left: 12px;
            background-color: white;
            padding: 0 5px;
            color: #777;
            font-size: 1.2rem;
            transition: 0.2s ease-in-out;
            pointer-events: none;
        }

        .form-group input:focus + label,
        .form-group input:not(:placeholder-shown) + label {
            top: -10px;
            left: 10px;
            font-size: 0.8rem;
            color: #007bff;
        }

        .form-group input:focus {
            border-color: #007bff;
        }

        /* Password criteria style */
        .password-criteria {
            display: none;
            margin-top: 5px;
            font-size: 0.9rem;
            color: #dc3545;
        }

        .password-criteria ul {
            padding-left: 20px;
        }

        .password-criteria li {
            margin-bottom: 5px;
        }

        .valid {
            color: green;
        }
    </style>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-blue fixed-top">
    <div class="container-fluid">
        <a class="navbar-brand" href="#">
            <!--<img th:src="@{/images/logo.png}"  src="../static/images/logo.png" width="auto" height="40" class="d-inline-block align-top" alt=""/>-->
            <h3 width="auto" height="40" class="d-inline-block align-top" alt="">E-commerce Shop</h3>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
	</div>
</nav>

<!-- Registration Form Centered in Flexbox Container -->
<div class="container" style="padding-top: 70px; margin-top: 10px">
    <div class="register-box">
        <h2>Register</h2>
        <form th:action="@{/VITproject/register}" method="post">
			
			<div class="form-group">
			    <input type="text" name="firstName" id="firstName" placeholder=" " class="form-control form-control-lg" required th:value="*{firstName}">
			    <label for="firstName">Name</label>
			 </div>

            <div class="form-group">
                <input type="email" name="email" id="email" placeholder=" " class="form-control form-control-lg" required th:value="*{email}">
                <label for="email">Email</label>
            </div>
			
			<div class="form-group">
			    <input type="text" name="phoneNum" id="phoneNum" placeholder=" " class="form-control form-control-lg" required th:value="*{phoneNum}">
			    <label for="phoneNum">Phone Number</label>
			</div>

            <div class="form-group">
                <input type="password" class="form-control form-control-lg" placeholder=" " name="password" id="password" required>
                <label for="password">Password</label>
                <!-- Password criteria section -->
                <div id="passwordCriteria" class="password-criteria">
                    <ul>
                        <li id="length" class="invalid">At least 8 characters</li>
                        <li id="uppercase" class="invalid">One uppercase letter</li>
                        <li id="lowercase" class="invalid">One lowercase letter</li>
                        <li id="number" class="invalid">One number</li>
                        <li id="special" class="invalid">One special character (e.g. !@#$%)</li>
                    </ul>
                </div>
            </div>
			<!--
            <div class="form-group">
                <input type="password" class="form-control form-control-lg" placeholder=" " name="confirm-password" id="confirm-password" required>
                <label for="confirm-password">Confirm Password</label>
            </div>-->

			<button type="button" class="btn btn-primary btn-block" onclick="validateForm()">Register</button>
		</form>
		<p class="text-center" style="margin-top: 20px;">
		    Already have an account? <a th:href="@{/VITproject/login}">Login here</a>
		</p>
    </div>
</div>

<!--Registration Error Modal-->
<div class="modal fade" id="regErrorModal" tabindex="-1" role="dialog" aria-labelledby="regErrorModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="regErrorModalLabel">Registration Error</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        Registration Error, Please try again.
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
<!-- JavaScript to toggle the password criteria visibility and check validity -->
<script>
    const passwordField = document.getElementById('password');
    const passwordCriteria = document.getElementById('passwordCriteria');
    const criteria = {
        length: document.getElementById('length'),
        uppercase: document.getElementById('uppercase'),
        lowercase: document.getElementById('lowercase'),
        number: document.getElementById('number'),
        special: document.getElementById('special')
    };

    passwordField.addEventListener('focus', function () {
        passwordCriteria.style.display = 'block'; // Show the criteria when password field is clicked
    });

    passwordField.addEventListener('blur', function () {
        passwordCriteria.style.display = 'none'; // Hide the criteria when clicking outside the password field
        checkPasswordStrength(); // Check password validity when losing focus
    });

    passwordField.addEventListener('input', function () {
        checkPasswordStrength(); // Check password validity while typing
    });

    function checkPasswordStrength() {
        const password = passwordField.value;
        criteria.length.className = password.length >= 8 ? 'valid' : 'invalid';
        criteria.uppercase.className = /[A-Z]/.test(password) ? 'valid' : 'invalid';
        criteria.lowercase.className = /[a-z]/.test(password) ? 'valid' : 'invalid';
        criteria.number.className = /\d/.test(password) ? 'valid' : 'invalid';
        criteria.special.className = /[!@#$%^&*(),.?":{}|<>]/.test(password) ? 'valid' : 'invalid';
    }
</script>

<!-- trigger if present -->
<script>
    function validateForm() {
        var errorMessage = "[[${errorMessage != null ? errorMessage : ''}]]"; // Set empty string if no error
		console.log("Error message:", errorMessage);

        if (errorMessage !== "") {
            $('#regErrorModal').modal('show');
        } else {
            // No error, submit the form
            document.querySelector('form').submit();
        }
    }

    // Show modal automatically on page load if errorMessage exists
    $(document).ready(function(){
        var errorMessageOnLoad = "[[${errorMessage != null ? errorMessage : ''}]]";
        if (errorMessageOnLoad !== "") {
            $('#regErrorModal').modal('show');
        }
    });
</script>
</body>
</html>
